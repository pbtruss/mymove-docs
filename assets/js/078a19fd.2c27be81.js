"use strict";(self.webpackChunkmymove_docs=self.webpackChunkmymove_docs||[]).push([[9640],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>f});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},d=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},c=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),c=p(n),f=o,m=c["".concat(s,".").concat(f)]||c[f]||u[f]||i;return n?r.createElement(m,a(a({ref:t},d),{},{components:n})):r.createElement(m,a({ref:t},d))}));function f(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,a=new Array(i);a[0]=c;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,a[1]=l;for(var p=2;p<i;p++)a[p]=n[p];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}c.displayName="MDXCreateElement"},15238:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>a,default:()=>u,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var r=n(87462),o=(n(67294),n(3905));const i={title:"0018 Optional Field Interop"},a="Optional Field Interop",l={unversionedId:"adrs/optional-field-interop",id:"adrs/optional-field-interop",title:"0018 Optional Field Interop",description:"Some of the fields in our API are optional. go-swagger represents optional fields using pointers, if the field is not present, the pointer is set to null. Pop (and the go database package in general) supports using pointers to represent null but are more geared toward using a special nullable field struct (NullString, NullInt, etc) where the struct has value and valid fields. The valid field indicates whether the optional field is present.",source:"@site/docs/adrs/0018-optional-field-interop.md",sourceDirName:"adrs",slug:"/adrs/optional-field-interop",permalink:"/mymove-docs/docs/adrs/optional-field-interop",draft:!1,editUrl:"https://github.com/transcom/mymove-docs/edit/main/docs/adrs/0018-optional-field-interop.md",tags:[],version:"current",sidebarPosition:18,frontMatter:{title:"0018 Optional Field Interop"},sidebar:"adrsSidebar",previous:{title:"0017 Client side route restriction based on authentication",permalink:"/mymove-docs/docs/adrs/react-router-redux-authentication"},next:{title:"0019 Range Slider React Component",permalink:"/mymove-docs/docs/adrs/client-rangeslider"}},s={},p=[{value:"Considered Alternatives",id:"considered-alternatives",level:2},{value:"Decision Outcome",id:"decision-outcome",level:2},{value:"Pros and Cons of the Alternatives",id:"pros-and-cons-of-the-alternatives",level:2},{value:"Use pointers to represent optional fields",id:"use-pointers-to-represent-optional-fields",level:3},{value:"Use null structs to represent optional fields",id:"use-null-structs-to-represent-optional-fields",level:3}],d={toc:p};function u(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"optional-field-interop"},"Optional Field Interop"),(0,o.kt)("p",null,"Some of the fields in our API are optional. go-swagger represents optional fields using pointers, if the field is not present, the pointer is set to null. Pop (and the go database package in general) supports using pointers to represent null but are more geared toward using a special nullable field struct (NullString, NullInt, etc) where the struct has ",(0,o.kt)("inlineCode",{parentName:"p"},"value")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"valid")," fields. The valid field indicates whether the optional field is present."),(0,o.kt)("p",null,"We have decided for now to adopt go-swagger's use of pointers throughout, defining our models as having pointers for all their optional fields."),(0,o.kt)("h2",{id:"considered-alternatives"},"Considered Alternatives"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Use pointers to represent optional fields"),(0,o.kt)("li",{parentName:"ul"},"Use null structs to represent optional fields")),(0,o.kt)("h2",{id:"decision-outcome"},"Decision Outcome"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Chosen Alternative: ",(0,o.kt)("strong",{parentName:"li"},"Use pointers to represent optional fields"))),(0,o.kt)("p",null,"Pointers are what go-swagger uses for optional fields so it makes conversions between the two representations of our data simpler. Additionally, pointers enforce the behavior of an Optional type where attempting to use the value of it when it is set to null results in a runtime error rather than silently succeeding in the case of the NullField."),(0,o.kt)("h2",{id:"pros-and-cons-of-the-alternatives"},"Pros and Cons of the Alternatives"),(0,o.kt)("h3",{id:"use-pointers-to-represent-optional-fields"},"Use pointers to represent optional fields"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"+")," This makes converting from the go-swagger representation of data to our model's representation of data simpler as for the basic types one can simply be set to the other."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"+")," Pointers correctly represent a Maybe/Optional type where they are either null or hold a value."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"-")," The purpose of pointers in go is to enable pass by reference or pass by value semantics, this use of them is not in any way related to that, so it is possible we will end up with some unexpected pointer related bugs by using them this way.")),(0,o.kt)("h3",{id:"use-null-structs-to-represent-optional-fields"},"Use null structs to represent optional fields"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"+")," This is how the database package and pop are documented to handle null fields."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"+")," We don't mix our desire for optional fields with the semantics of reference and value, our models would not have pointers in them needlessly, cutting down on pointer bugs."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"-")," Converting from the go-swagger representation to our models would require more helper functions to make easy."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"-")," A NullString is only an OK maybe type. There is nothing stopping you from using the value in an instance where the valid bit is false. At least with a pointer your program will crash if you try the same thing.")))}u.isMDXComponent=!0}}]);