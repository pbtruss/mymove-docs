"use strict";(self.webpackChunkmymove_docs=self.webpackChunkmymove_docs||[]).push([[9504],{3905:function(e,t,a){a.d(t,{Zo:function(){return u},kt:function(){return m}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var c=n.createContext({}),l=function(e){var t=n.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},u=function(e){var t=l(e.components);return n.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,c=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=l(a),m=r,v=p["".concat(c,".").concat(m)]||p[m]||d[m]||i;return a?n.createElement(v,o(o({ref:t},u),{},{components:a})):n.createElement(v,o({ref:t},u))}));function m(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=p;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var l=2;l<i;l++)o[l]=a[l];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}p.displayName="MDXCreateElement"},5817:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return s},contentTitle:function(){return c},metadata:function(){return l},toc:function(){return u},default:function(){return p}});var n=a(7462),r=a(3366),i=(a(7294),a(3905)),o=["components"],s={},c="How To Create or Deactivate Users",l={unversionedId:"old-wiki/create-or-deactivate-users",id:"old-wiki/create-or-deactivate-users",isDocsHomePage:!1,title:"How To Create or Deactivate Users",description:"Creating Users",source:"@site/docs/old-wiki/create-or-deactivate-users.md",sourceDirName:"old-wiki",slug:"/old-wiki/create-or-deactivate-users",permalink:"/mymove-docs/docs/old-wiki/create-or-deactivate-users",editUrl:"https://github.com/facebook/docusaurus/edit/main/website/docs/old-wiki/create-or-deactivate-users.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"How To Create An ECS Scheduled Task",permalink:"/mymove-docs/docs/old-wiki/create-an-ecs-scheduled-task"},next:{title:"Database Guides",permalink:"/mymove-docs/docs/old-wiki/database"}},u=[{value:"Creating Users",id:"creating-users",children:[{value:"Creating DPS Users",id:"creating-dps-users",children:[]}]},{value:"Deactivating Users",id:"deactivating-users",children:[{value:"Deactivating Users Globally",id:"deactivating-users-globally",children:[]},{value:"Deactivating Office Users",id:"deactivating-office-users",children:[]},{value:"Deactivating DPS Users",id:"deactivating-dps-users",children:[]},{value:"Generating a migration to deactivate a specific user",id:"generating-a-migration-to-deactivate-a-specific-user",children:[]}]}],d={toc:u};function p(e){var t=e.components,a=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"how-to-create-or-deactivate-users"},"How To Create or Deactivate Users"),(0,i.kt)("h2",{id:"creating-users"},"Creating Users"),(0,i.kt)("p",null,"We now create users for the Office and Admin applications in the Admin console and not via secure migrations so that we can capture the security object audit logs."),(0,i.kt)("h3",{id:"creating-dps-users"},"Creating DPS Users"),(0,i.kt)("p",null,"For creating users let's assume that the new user's email is ",(0,i.kt)("a",{parentName:"p",href:"mailto:username@example.com"},"username@example.com"),"."),(0,i.kt)("p",null,"Here is an example migration to create a DPS user (please edit as needed):"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"INSERT INTO public.dps_users\n    (id, login_gov_email,\n     created_at, updated_at, active)\n    VALUES (\n        GENERATED_UUID4_VAL, 'username@example.com',\n        now(), now(), true\n    );\n")),(0,i.kt)("h2",{id:"deactivating-users"},"Deactivating Users"),(0,i.kt)("p",null,"MilMove doesn't delete users because of both auditing concerns and CASCADE DELETE failures. Instead each\nuser table has a ",(0,i.kt)("inlineCode",{parentName:"p"},"active")," boolean column that can be used to deactivate a user. Deactivating a user means the\nperson with valid credentials to Login.gov may not be permitted to get a session in MilMove."),(0,i.kt)("p",null,"There are several places you can deactivate a user, at the global level and at each application level. It's important\nto deactivate users at the application level if you are concerned that a user entry was made for the user in that\ntable but they have not yet claimed the user entry by logging in. This is an issue to be aware of for both Office\nand Admin users."),(0,i.kt)("h3",{id:"deactivating-users-globally"},"Deactivating Users Globally"),(0,i.kt)("p",null,"An example of deactivating a user by email:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"UPDATE users SET active = false WHERE email = 'username@example.com';\n")),(0,i.kt)("p",null,"This is the only way to deactivate Service Members."),(0,i.kt)("h3",{id:"deactivating-office-users"},"Deactivating Office Users"),(0,i.kt)("p",null,"This should now be done in the admin user application:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Navigate to the admin app and log in"),(0,i.kt)("li",{parentName:"ol"},'Click on "Office Users" in the sidebar'),(0,i.kt)("li",{parentName:"ol"},'Select the user you would like to deactivate and click "Edit" in the top right\ncorner. Here, you\'ll be able to choose whether or not that user is deactivated.')),(0,i.kt)("h3",{id:"deactivating-dps-users"},"Deactivating DPS Users"),(0,i.kt)("p",null,"An example of deactivating a DPS user by email:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"UPDATE dps_users SET active = false WHERE email = 'username@example.com';\n")),(0,i.kt)("h3",{id:"generating-a-migration-to-deactivate-a-specific-user"},"Generating a migration to deactivate a specific user"),(0,i.kt)("p",null,"We may need to deactivate specific milmove (not office or admin) users. Until this functionality is available in the admin console, you can use the following ",(0,i.kt)("inlineCode",{parentName:"p"},"milmove")," sub-command:"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"milmove gen disable-user-migration -e EMAIL")))}p.isMDXComponent=!0}}]);