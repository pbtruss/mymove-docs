"use strict";(self.webpackChunkmymove_docs=self.webpackChunkmymove_docs||[]).push([[5517],{3905:function(e,t,n){n.d(t,{Zo:function(){return l},kt:function(){return d}});var r=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var c=r.createContext({}),p=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},l=function(e){var t=p(e.components);return r.createElement(c.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,c=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),u=p(n),d=i,h=u["".concat(c,".").concat(d)]||u[d]||m[d]||o;return n?r.createElement(h,a(a({ref:t},l),{},{components:n})):r.createElement(h,a({ref:t},l))}));function d(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,a=new Array(o);a[0]=u;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:i,a[1]=s;for(var p=2;p<o;p++)a[p]=n[p];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},37452:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return c},metadata:function(){return p},toc:function(){return l},default:function(){return u}});var r=n(87462),i=n(63366),o=(n(67294),n(3905)),a=["components"],s={},c="How To Unit Test React Components",p={unversionedId:"dev/testing/writing-tests/unit-test-react-components",id:"dev/testing/writing-tests/unit-test-react-components",isDocsHomePage:!1,title:"How To Unit Test React Components",description:"Unit testing React components has been done with Enzyme, but we now favor a library called React Testing Library (RTL) for unit tests. Please see this page comparing them and outlining a guide for when to use which library. As a general rule of thumb, new components should be tested using RTL.",source:"@site/docs/dev/testing/writing-tests/unit-test-react-components.md",sourceDirName:"dev/testing/writing-tests",slug:"/dev/testing/writing-tests/unit-test-react-components",permalink:"/mymove-docs/docs/dev/testing/writing-tests/unit-test-react-components",editUrl:"https://github.com/transcom/mymove-docs/edit/main/docs/dev/testing/writing-tests/unit-test-react-components.md",tags:[],version:"current",frontMatter:{},sidebar:"devSidebar",previous:{title:"How To Generate Mocks with Mockery",permalink:"/mymove-docs/docs/dev/testing/writing-tests/generate-mocks-with-mockery"},next:{title:"Interacting-with-the-DB-in-Go-server-tests",permalink:"/mymove-docs/docs/dev/testing/test-data/Interacting-with-the-DB-in-Go-server-tests"}},l=[{value:"Shallow Rendering",id:"shallow-rendering",children:[]},{value:"Full Rendering",id:"full-rendering",children:[]},{value:"Static Rendering",id:"static-rendering",children:[]}],m={toc:l};function u(e){var t=e.components,n=(0,i.Z)(e,a);return(0,o.kt)("wrapper",(0,r.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"how-to-unit-test-react-components"},"How To Unit Test React Components"),(0,o.kt)("p",null,"Unit testing React components has been done with Enzyme, but we now favor a library called ",(0,o.kt)("a",{parentName:"p",href:"https://testing-library.com/docs/react-testing-library/intro/"},"React Testing Library")," (RTL) for unit tests. Please see ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/transcom/mymove/wiki/Writing-Frontend-Tests:-Enzyme-and-React-Testing-Library"},"this page")," comparing them and outlining a guide for when to use which library. As a general rule of thumb, new components should be tested using RTL.\nYou can also look at our page on ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/transcom/mymove/wiki/Writing-Tests-Using-React-Testing-Library-and-Jest"},"Writing Tests Using React Testing Library and Jest")," for more info."),(0,o.kt)("p",null,"Below is a guide to Enzyme written before we introduced RTL:"),(0,o.kt)("p",null,"Unit testing React components with Enzyme requires familiarity with two libraries:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://jestjs.io/docs/en/expect"},"Jest"),", our test framework and runner"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://airbnb.io/enzyme/docs/api/"},"Enzyme"),", a React component testing library")),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Note that the version of Jest we're using is dictated by ",(0,o.kt)("inlineCode",{parentName:"em"},"create-react-app")," and tends to lag behind the latest releases.")),(0,o.kt)("p",null,"The basic pattern for unit testing React components is:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},'"Render" the component using either ',(0,o.kt)("inlineCode",{parentName:"li"},"shallow")," or ",(0,o.kt)("inlineCode",{parentName:"li"},"mount"),". Pass in whatever ",(0,o.kt)("inlineCode",{parentName:"li"},"props")," are needed to by the component."),(0,o.kt)("li",{parentName:"ol"},"Make assertions against the component state using Jest and Enzyme.")),(0,o.kt)("p",null,"It's best to avoid testing network requests or Redux when unit testing a component. If your component does either of these things, it is probably worth restructuring your code using the container pattern so that the inner component can be easily tested."),(0,o.kt)("p",null,"Remember that the value returned by either ",(0,o.kt)("inlineCode",{parentName:"p"},"shallow"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"mount"),", or ",(0,o.kt)("inlineCode",{parentName:"p"},"render")," will be a different object in each case and have different behavior as a result."),(0,o.kt)("h2",{id:"shallow-rendering"},"Shallow Rendering"),(0,o.kt)("p",null,"Shallow rendering renders a component but not any of its children. You'll want to keep this in mind when writing your assertions."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"import React from 'react';\nimport { shallow } from 'enzyme';\nimport HHGWeightWarning from './HHGWeightWarning';\n\ndescribe('HHG with too high a weight estimate', function() {\n  const shipment = { weight_estimate: 12000 };\n  const entitlements = { weight: 10000 };\n  const wrapper = shallow(<HHGWeightWarning shipment={shipment} entitlements={entitlements} />);\n\n  it('shows a warning if the estimated weight is too high', function() {\n    expect(wrapper.text()).toContain(\n      'Your weight estimate of 12,000 is 2,000 lbs over your maximum entitlement of 10,000 lbs.',\n    );\n  });\n});\n")),(0,o.kt)("p",null,"If you need to see if a React component exists in the render tree, use the Enzyme API to check for it:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"describe('with valid weights', function() {\n  const shipment = { weight_estimate: 1000, progear_weight_estimate: 200, spouse_progear_weight_estimate: 200 };\n  const entitlements = { weight: 2000, pro_gear: 300, pro_gear_spouse: 300 };\n  const wrapper = shallow(<HHGWeightWarning shipment={shipment} entitlements={entitlements} />);\n\n  it('shows no alerts', function() {\n    expect(wrapper.containsMatchingElement(Alert)).toEqual(false);\n  });\n});\n")),(0,o.kt)("p",null,"Alternatively, you can use ",(0,o.kt)("inlineCode",{parentName:"p"},"html()")," to render a node to HTML and make assertions against the markup."),(0,o.kt)("h2",{id:"full-rendering"},"Full Rendering"),(0,o.kt)("p",null,"While providing a more realistic perspective on the application's behavior, using ",(0,o.kt)("inlineCode",{parentName:"p"},"mount")," can be problematic. One cause of this is that certain components (such as ",(0,o.kt)("inlineCode",{parentName:"p"},"Link")," from ",(0,o.kt)("inlineCode",{parentName:"p"},"react-router"),") can't be rendered unless they appear beneath another component or provider. In such a case, you'll need to setup any providers or parent components and render the component under test inside them."),(0,o.kt)("p",null,"For example, if a component needs to be rendered within a ",(0,o.kt)("inlineCode",{parentName:"p"},"Provider")," that provides the ",(0,o.kt)("inlineCode",{parentName:"p"},"store")," prop, you'll need to render it like so in a test:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"import React from 'react';\nimport { Provider } from 'react-redux';\nimport ReactDOM from 'react-dom';\nimport configureStore from 'redux-mock-store';\nimport { mount } from 'enzyme';\n\ndescribe('HomePage tests', () => {\n  const mockStore = configureStore();\n  let store;\n  describe('When the user has never logged in before', function() {\n    store = mockStore({});\n    const wrapper = mount(\n      <Provider store={store}>\n        <ComponentThatNeedsAccessToTheStore />\n      </Provider>,\n    );\n\n    // assertions go here\n  });\n});\n")),(0,o.kt)("p",null,"Generally, however, it is recommended to use the container pattern to separate the data access and rendering concerns of a component and to focus unit tests on the inner component."),(0,o.kt)("h2",{id:"static-rendering"},"Static Rendering"),(0,o.kt)("p",null,"Static rendering renders a React component to HTML and provides a ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/cheeriojs/cheerio/tree/aa90399c9c02f12432bfff97b8f1c7d8ece7c307#api"},"nice API")," for traversing the resulting markup."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"import React from 'react';\nimport { render } from 'enzyme';\nimport HHGWeightWarning from './HHGWeightWarning';\n\ndescribe('with valid weights', function() {\n  const shipment = { weight_estimate: 1000, progear_weight_estimate: 200, spouse_progear_weight_estimate: 200 };\n  const entitlements = { weight: 2000, pro_gear: 300, pro_gear_spouse: 300 };\n  const wrapper = render(<HHGWeightWarning shipment={shipment} entitlements={entitlements} />);\n\n  it('shows no alerts', function() {\n    expect(wrapper.find('.usa-alert').length).toEqual(0);\n  });\n});\n")))}u.isMDXComponent=!0}}]);