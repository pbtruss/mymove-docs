"use strict";(self.webpackChunkmymove_docs=self.webpackChunkmymove_docs||[]).push([[5409],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return u}});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),m=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=m(e.components);return a.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=m(n),u=r,h=d["".concat(s,".").concat(u)]||d[u]||p[u]||o;return n?a.createElement(h,i(i({ref:t},c),{},{components:n})):a.createElement(h,i({ref:t},c))}));function u(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var m=2;m<o;m++)i[m]=n[m];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},96277:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return m},toc:function(){return c},default:function(){return d}});var a=n(87462),r=n(63366),o=(n(67294),n(3905)),i=["components"],l={},s="Running telemetry locally",m={unversionedId:"tools/telemetry/running-telemetry-locally",id:"tools/telemetry/running-telemetry-locally",isDocsHomePage:!1,title:"Running telemetry locally",description:"Because we are using open telemetry, we can use one telemetry system",source:"@site/docs/tools/telemetry/running-telemetry-locally.md",sourceDirName:"tools/telemetry",slug:"/tools/telemetry/running-telemetry-locally",permalink:"/mymove-docs/docs/tools/telemetry/running-telemetry-locally",editUrl:"https://github.com/transcom/mymove-docs/edit/main/docs/tools/telemetry/running-telemetry-locally.md",tags:[],version:"current",frontMatter:{},sidebar:"toolsSidebar",previous:{title:"Introduction & Basics",permalink:"/mymove-docs/docs/tools/schemaspy/schemaspy"},next:{title:"Viewing Telemetry Logs in the Load Testing Environment",permalink:"/mymove-docs/docs/tools/telemetry/viewing-telemetry-logs-in-load-testing"}},c=[{value:"Setup",id:"setup",children:[]},{value:"Troubleshooting",id:"troubleshooting",children:[]}],p={toc:c};function d(e){var t=e.components,l=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},p,l,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"running-telemetry-locally"},"Running telemetry locally"),(0,o.kt)("p",null,"Because we are using open telemetry, we can use one telemetry system\nin production (AWS) and another one locally. More information on why open telemetry was chosen is available in this ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/transcom/mymove/blob/6feaa5b79cfd20276dd670babdbf0b31351a2fb4/docs/adr/0061-use-opentelemetry-for-distributed-tracing.md"},"ADR"),"."),(0,o.kt)("p",null,"Running the elastic search offering locally turns out to be easy."),(0,o.kt)("h2",{id:"setup"},"Setup"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"In one terminal window run ",(0,o.kt)("inlineCode",{parentName:"p"},"docker-compose -f docker-compose.telemetry.yml up")),(0,o.kt)("div",{parentName:"li",className:"admonition admonition-danger alert alert--danger"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"You may encounter errors")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Docker Compose may report errors similar to the following: ",(0,o.kt)("inlineCode",{parentName:"p"},'ERROR: for apm-server  Container "4aa42b9f5715" is unhealthy')," or ",(0,o.kt)("inlineCode",{parentName:"p"},'ERROR: for apm-server Container "4aa42b9f5715" is unhealthy')," this may be an indication that docker doesn't have enough memory. To resolve this issue open up Docker Desktop. Click the gear icon in the header as shown below:"),(0,o.kt)("p",{parentName:"div"},(0,o.kt)("img",{alt:"docker settings",src:n(83174).Z})),(0,o.kt)("p",{parentName:"div"},"You can then click ",(0,o.kt)("inlineCode",{parentName:"p"},"Resources")," on the left nav bar and modify the ",(0,o.kt)("inlineCode",{parentName:"p"},"Memory")," slider to ",(0,o.kt)("inlineCode",{parentName:"p"},"8.00 GB"),". Click ",(0,o.kt)("inlineCode",{parentName:"p"},"Apply & Restart"),". Once you have done this rerun the original command."),(0,o.kt)("p",{parentName:"div"},(0,o.kt)("img",{alt:"changed docker settings",src:n(3914).Z}))))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"In another, run ",(0,o.kt)("inlineCode",{parentName:"p"},"TELEMETRY_ENDPOINT=localhost:55680 TELEMETRY_ENABLED=1 make server_run"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Visit ",(0,o.kt)("a",{parentName:"p",href:"http://localhost:5601"},"http://localhost:5601")),(0,o.kt)("p",{parentName:"li"},(0,o.kt)("img",{alt:"Kibana home page",src:n(58654).Z}))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"To start collecting information you must run the mymove app locally. To do this navigate to the mymove repo and run the command ",(0,o.kt)("inlineCode",{parentName:"p"},"make client_run")," to start up the local server. You can then navigate through the app to start collecting data.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"To view this data, on the Kibana page you can click the ",(0,o.kt)("inlineCode",{parentName:"p"},"Observability")," panel and then navigate to the ",(0,o.kt)("inlineCode",{parentName:"p"},"APM")," -> ",(0,o.kt)("inlineCode",{parentName:"p"},"Services")," section on the left hand navigation bar."),(0,o.kt)("p",{parentName:"li"},(0,o.kt)("img",{alt:"Services Dashboard",src:n(18428).Z})),(0,o.kt)("div",{parentName:"li",className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Services are all named ",(0,o.kt)("inlineCode",{parentName:"p"},"unknown_service_milmove_gin")," and all local transactions besides logging in and logging out are called ",(0,o.kt)("inlineCode",{parentName:"p"},"server-no-tls"),". This is a known ",(0,o.kt)("a",{parentName:"p",href:"https://dp3.atlassian.net/browse/MB-9926"},"bug"),"."))))),(0,o.kt)("h2",{id:"troubleshooting"},"Troubleshooting"),(0,o.kt)("p",null,"This is a list of common errors that you might see and what they mean:"),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"Context deadline exceeded")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},(0,o.kt)("inlineCode",{parentName:"p"},"context deadline exceeded")," this is an indication that it can't reach the telemetry server."))))}d.isMDXComponent=!0},3914:function(e,t,n){t.Z=n.p+"assets/images/docker_resources-1bd302c515b3010a7bfbc70a8057477c.png"},83174:function(e,t,n){t.Z=n.p+"assets/images/docker_settings-125ca6beeb2117ce505d6268a1ad5f26.png"},58654:function(e,t,n){t.Z=n.p+"assets/images/kibana-home-page-17ace68eb895529b62b6c70a1ca0afae.png"},18428:function(e,t,n){t.Z=n.p+"assets/images/services-dashboard-b509a5a1fbb3677709240ed32c7fa6f3.png"}}]);