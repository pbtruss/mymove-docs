"use strict";(self.webpackChunkmymove_docs=self.webpackChunkmymove_docs||[]).push([[6562],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>u});var r=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=r.createContext({}),p=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},d=function(e){var t=p(e.components);return r.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,l=e.parentName,d=a(e,["components","mdxType","originalType","parentName"]),m=p(n),u=i,f=m["".concat(l,".").concat(u)]||m[u]||c[u]||o;return n?r.createElement(f,s(s({ref:t},d),{},{components:n})):r.createElement(f,s({ref:t},d))}));function u(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,s=new Array(o);s[0]=m;var a={};for(var l in t)hasOwnProperty.call(t,l)&&(a[l]=t[l]);a.originalType=e,a.mdxType="string"==typeof e?e:i,s[1]=a;for(var p=2;p<o;p++)s[p]=n[p];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},36992:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>c,frontMatter:()=>o,metadata:()=>a,toc:()=>p});var r=n(87462),i=(n(67294),n(3905));const o={title:"0070 Use a consistent file structure for cypress tests"},s="Use a consistent file structure for cypress tests",a={unversionedId:"adrs/cypress-tests-file-layout",id:"adrs/cypress-tests-file-layout",title:"0070 Use a consistent file structure for cypress tests",description:"In the MilMove code base there is a previous iteration of PPM code and related cypress tests. Those older cypress tests were in two files cypress/integration/mymove/ppm.js and cypress/integration/mymove/ppmCloseout.js. These tests, before they were commented out, were long and later portions were dependent on earlier ones which occasionally caused failures that were difficult to find.",source:"@site/docs/adrs/0070-cypress-tests-file-layout.md",sourceDirName:"adrs",slug:"/adrs/cypress-tests-file-layout",permalink:"/mymove-docs/docs/adrs/cypress-tests-file-layout",draft:!1,editUrl:"https://github.com/transcom/mymove-docs/edit/main/docs/adrs/0070-cypress-tests-file-layout.md",tags:[],version:"current",sidebarPosition:70,frontMatter:{title:"0070 Use a consistent file structure for cypress tests"},sidebar:"adrsSidebar",previous:{title:"0069 Use orchestrator service objects",permalink:"/mymove-docs/docs/adrs/use-orchestrator-service-objects"},next:{title:"0071 Introduce Move History Events",permalink:"/mymove-docs/docs/adrs/move-history-events"}},l={},p=[{value:"Considered Alternatives (bold denotes chosen)",id:"considered-alternatives-bold-denotes-chosen",level:2},{value:"Decision Outcome",id:"decision-outcome",level:2},{value:"Pros and Cons of the Alternatives",id:"pros-and-cons-of-the-alternatives",level:2},{value:"Keep every test for the new PPM flow in a <code>ppm.js</code> file",id:"keep-every-test-for-the-new-ppm-flow-in-a-ppmjs-file",level:3},{value:"Create new files in the same location",id:"create-new-files-in-the-same-location",level:3},{value:"Create a single new test file",id:"create-a-single-new-test-file",level:3},{value:"Create a new folder with new test files",id:"create-a-new-folder-with-new-test-files",level:3}],d={toc:p};function c(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"use-a-consistent-file-structure-for-cypress-tests"},"Use a consistent file structure for cypress tests"),(0,i.kt)("p",null,"In the MilMove code base there is a previous iteration of PPM code and related cypress tests. Those older cypress tests were in two files ",(0,i.kt)("inlineCode",{parentName:"p"},"cypress/integration/mymove/ppm.js")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"cypress/integration/mymove/ppmCloseout.js"),". These tests, before they were commented out, were long and later portions were dependent on earlier ones which occasionally caused failures that were difficult to find."),(0,i.kt)("p",null,"In thinking through how to improve things while work on the new iteration of PPM features started, it seemed better to break the tests up into individual tests per page of the on-boarding flow instead of trying have one test that went through the whole flow. To organize them further they are all under a ",(0,i.kt)("inlineCode",{parentName:"p"},"ppm")," folder since they are all tied to the PPM features directly."),(0,i.kt)("p",null,"An update here is that the current tests live in a ",(0,i.kt)("inlineCode",{parentName:"p"},"mymove")," folder but since that name no longer applies to the customer app we created a new one ",(0,i.kt)("inlineCode",{parentName:"p"},"milmove")," with the intention of moving other tests that still apply to the customer portion into the new directory."),(0,i.kt)("h2",{id:"considered-alternatives-bold-denotes-chosen"},"Considered Alternatives (bold denotes chosen)"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Keep every test for the new PPM flow in a ",(0,i.kt)("inlineCode",{parentName:"li"},"ppm.js")," file"),(0,i.kt)("li",{parentName:"ul"},"Create new files in the same location"),(0,i.kt)("li",{parentName:"ul"},"Create a single new test file"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Create a new folder with new test files"))),(0,i.kt)("h2",{id:"decision-outcome"},"Decision Outcome"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Chosen Alternative:")," Create a new folder with new test files"),(0,i.kt)("p",null,"The recommendation is to keep the test files small and easy to follow, testing specific parts of a feature or page. If there are many files for one large feature a directory can be created to group the files together."),(0,i.kt)("p",null,"Example of this is the new PPM customer flow cypress tests in ",(0,i.kt)("inlineCode",{parentName:"p"},"cypress/integration/milmove/ppms")," directory."),(0,i.kt)("p",null,"Recommend short test files over long ones. Long ones have been harder to debug in the past and have sometimes setup dependent tests."),(0,i.kt)("p",null,"It was a choice at the time of the first PPM tests for the new flow to not migrate all the tests. It was not possible given the time constraints at the time. However, to make the distinction between the old PPM tests and the new PPM tests it seemed prudent to create the new ",(0,i.kt)("inlineCode",{parentName:"p"},"milmove")," directory."),(0,i.kt)("p",null,"This approach increases the likely hood that our tests will have repeated sections. This can be mitigated by the creation of functions that can be reused instead of repeating the code. This ADR doesn't dictate an approach and leaves it to the best judgement of those working with the tests. General rule of thumb though is if you need to repeate a section of code for a third time it's a good time to consider pulling that code into a reusable function."),(0,i.kt)("p",null,"While this started during the PPM work the new file recommendation is applicable to current and future tests. We should update existing tests to follow the new pattern as we are able and makes sense."),(0,i.kt)("h2",{id:"pros-and-cons-of-the-alternatives"},"Pros and Cons of the Alternatives"),(0,i.kt)("h3",{id:"keep-every-test-for-the-new-ppm-flow-in-a-ppmjs-file"},"Keep every test for the new PPM flow in a ",(0,i.kt)("inlineCode",{parentName:"h3"},"ppm.js")," file"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"+")," No new files"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"+")," Files with old tests are updated"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"-")," Only one file for entire PPM on-boarding flow"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"-")," Long tests or lots of tests in one file can be hard to understand, follow, and debug"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"-")," Customer cypress tests in ",(0,i.kt)("inlineCode",{parentName:"li"},"mymove")," directory instead of ",(0,i.kt)("inlineCode",{parentName:"li"},"milmove"))),(0,i.kt)("h3",{id:"create-new-files-in-the-same-location"},"Create new files in the same location"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"+")," Maintains current pattern of tests"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"-")," Old PPM tests in same space as new PPM tests will lead to more confusion"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"-")," Customer cypress tests in ",(0,i.kt)("inlineCode",{parentName:"li"},"mymove")," directory instead of ",(0,i.kt)("inlineCode",{parentName:"li"},"milmove"))),(0,i.kt)("h3",{id:"create-a-single-new-test-file"},"Create a single new test file"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"+")," Maintains current pattern of tests"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"-")," Long cypress tests files get confusing quick"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"-")," Can be harder to debug"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"-")," Customer cypress tests in ",(0,i.kt)("inlineCode",{parentName:"li"},"mymove")," directory instead of ",(0,i.kt)("inlineCode",{parentName:"li"},"milmove"))),(0,i.kt)("h3",{id:"create-a-new-folder-with-new-test-files"},"Create a new folder with new test files"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"+")," New pattern for short cypress tests avoids long test files"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"+")," Short cypress files avoids long hard to diagnose tests"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"+")," Clear distinction of old and new PPM tests"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"+")," Smaller tests make it easier to write cypress tests as the larger feature is being developed"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"-")," Opportunity to rename ",(0,i.kt)("inlineCode",{parentName:"li"},"mymove")," to ",(0,i.kt)("inlineCode",{parentName:"li"},"milmove")," in the cypress test folder"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"-")," If all tests are not moved right away will have competing locations for storing new customer cypress tests")))}c.isMDXComponent=!0}}]);