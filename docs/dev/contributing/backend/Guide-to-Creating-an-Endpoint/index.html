<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.5">
<title data-react-helmet="true">Creating an Endpoint | MilMove Developer Portal</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://transcom.github.io/mymove-docs/docs/dev/contributing/backend/Guide-to-Creating-an-Endpoint"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Creating an Endpoint | MilMove Developer Portal"><meta data-react-helmet="true" name="description" content="These are the various steps that are involved in creating a new endpoint."><meta data-react-helmet="true" property="og:description" content="These are the various steps that are involved in creating a new endpoint."><link data-react-helmet="true" rel="shortcut icon" href="/mymove-docs/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://transcom.github.io/mymove-docs/docs/dev/contributing/backend/Guide-to-Creating-an-Endpoint"><link data-react-helmet="true" rel="alternate" href="https://transcom.github.io/mymove-docs/docs/dev/contributing/backend/Guide-to-Creating-an-Endpoint" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://transcom.github.io/mymove-docs/docs/dev/contributing/backend/Guide-to-Creating-an-Endpoint" hreflang="x-default"><link rel="stylesheet" href="/mymove-docs/assets/css/styles.2fa8fb56.css">
<link rel="preload" href="/mymove-docs/assets/js/runtime~main.30b48e55.js" as="script">
<link rel="preload" href="/mymove-docs/assets/js/main.b3ed7c5f.js" as="script">
</head>
<body data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/mymove-docs/"><img src="/mymove-docs/img/logo.svg" alt="MilMove Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/mymove-docs/img/logo.svg" alt="MilMove Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">MilMove.dev</b></a><a class="navbar__item navbar__link" href="/mymove-docs/docs/about/">About</a><a class="navbar__item navbar__link navbar__link--active" href="/mymove-docs/docs/">Docs</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link">APIs</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/mymove-docs/api/prime">Prime</a></li><li><a class="dropdown__link" href="/mymove-docs/api/support">Support</a></li></ul></div><a class="navbar__item navbar__link" href="/mymove-docs/docs/help/">Help</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/transcom/mymove" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>mymove<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="dsla-search-wrapper"><div class="dsla-search-field"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/mymove-docs/docs/">MilMove Developer Docs</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#">Getting Started</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/getting-started/Designers-guide-to-setting-up-app-locally">Designers&#x27;s guide to setting up app locally</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/getting-started/How-to-Test-the-Prime-API">How to Test the Prime API</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/getting-started/How-to-view-a-move-or-payment-request-in-the-office-app-as-a-TOO-or-TIO">How to view a move or payment request in the office app as a TOO or TIO</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Contributing</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Frontend</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Backend</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/structure">Structure</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/API-Errors">API-Errors</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/API-Programming-Guide">API-Programming-Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/API-Style-Guide">API-Style-Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/Dockerfile-use,-purpose,-and-documentation">Dockerfile-use,-purpose,-and-documentation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/Feature-Flags-in-the-App">Feature-Flags-in-the-App</a></li><li class="menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/Guide-to-Creating-an-Endpoint">Creating an Endpoint</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/How-to-Add-an-Event-Trigger">How-to-Add-an-Event-Trigger</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/How-to-Set-Up-a-Feature-Flag">How to Set Up a Feature Flag</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/Push-Notifications-to-Prime">Push-Notifications-to-Prime</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/Session-Management">Session-Management</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/Using-EagerPreload-in-Pop">Using-EagerPreload-in-Pop</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/WIP-Server-side-validation">WIP-Server-side-validation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/access-global-variables">How to Access a Global Application Variable</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/add-application-logging">How to Add Application Logging</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">GHC Invoicing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/golang-guide">Golang Programming Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/golang-loops">Loop Iteration in Golang</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/golang-time">Time in Golang</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/handle-backend-errors">How to handle back-end errors</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/route-planner">Route Planner Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/service-objects">Service Objects</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/service-validation">Validation in Service Objects</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/soft-delete">How to Soft Delete</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/use-optimistic-locking">What Is Optimistic Locking?</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Database</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Code Analysis</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Testing</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Tools</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Versioning</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Demo</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1>Creating an Endpoint</h1></header><h6><a aria-hidden="true" tabindex="-1" class="anchor anchor__h6 anchorWithStickyNavbar_31ik" id="these-are-the-various-steps-that-are-involved-in-creating-a-new-endpoint"></a>These are the various steps that are involved in creating a new endpoint.<a class="hash-link" href="#these-are-the-various-steps-that-are-involved-in-creating-a-new-endpoint" title="Direct link to heading">#</a></h6><p>Prior to creating an endpoint in the Handler folder, we must first add a new endpoint definition to swagger. We are using Swagger 2.0, which is <a href="https://swagger.io/specification/v2/" target="_blank" rel="noopener noreferrer">OpenAPI</a>, a specification we use to format our RESTful APIs and provide a template for us to communicate the information in our API.
Always start with swagger. This step creates your endpoint definition and generates the files and helper functions you will need to create your endpoint. More specifically, swagger converts JSON user input into generated Go types.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="adding--a-new-entry-into-the-yaml"></a>Adding  a new entry into the yaml<a class="hash-link" href="#adding--a-new-entry-into-the-yaml" title="Direct link to heading">#</a></h2><p>All new definitions will be added in <code>mymove/swagger-def</code>. Note that we have broken down our spec into different files and we share definitions between files.
Built compiled versions of our API spec will be generated and stored in the swagger folder, which we will not edit directly. Notice that there is a yaml file for each of our APIs.
An endpoint definition for the prime will go into the Prime yaml, but you may notice there are some definitions in <code>mymove/swagger-def/definitions</code>.
This is because some definitions are shared across APIs and we&#x27;ve created a space to add those definitions in one place.
For example, <code>Uploads.yaml</code> shares its definition across various APIs, and rather than creating various yaml files for this action, we have created one and added it to the shared <code>definitions</code> folder.</p><p>For the purposes for adding a new endpoint, make sure that your endpoint is defined in these sections:</p><ul><li><code>tags</code> - is where we group all of our endpoints by category (i.e. shipment endpoints, agent endpoints, service item endpoints, etc.).
This top level field is where our gen files will divide the endpoints into their own packages. Tag component names are <code>camelCase</code>.</li><li><code>paths</code> - defines our endpoint. Path names use <code>kebab-case</code>.</li><li><code>definitions</code> - defines the shape of the data for our endpoint. Definitions component names are <code>PascalCase</code>.</li><li><code>responses</code> - define what the endpoints return. Responses component names are <code>PascalCase</code>.</li><li><code>parameters</code> - define what an endpoint needs (e.g. headers). Parameter component names are <code>camelCase</code>.</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="troubleshooting-your-local-swagger-state"></a>Troubleshooting your local swagger state:<a class="hash-link" href="#troubleshooting-your-local-swagger-state" title="Direct link to heading">#</a></h4><p>If you are having issues with your local swagger state it is recommended to run <code>make server_generate</code>, accept the prompt, and then run <code>make server_run</code> again. For more information on troubleshooting, <a href="https://ustcdp3.slack.com/archives/CP6PTUPQF/p1632254277386600" target="_blank" rel="noopener noreferrer">this</a> explanation will be helpful.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="defining-a-path-for-your-endpoint"></a>Defining a path for your endpoint<a class="hash-link" href="#defining-a-path-for-your-endpoint" title="Direct link to heading">#</a></h4><p>For more information about URL design and structure checkout: <a href="https://transcom.github.io/mymove-docs/docs/dev/contributing/backend/API-Style-Guide" target="_blank" rel="noopener noreferrer">API Style Guide</a></p><p>Defining your endpoint path follows this simple convention:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">    /your path:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        HTTP request:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            summary: this is the name of the action your endpoint performs, in camelCase</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            description: new convention is to reference description files in the swagger-def/info/ folder</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            operationId: this should match the endpoint title in the definitions section and summary in your paths section.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            tags: matches the tag section for this endpoint</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            produces: this field will always be application/json</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            parameters: include parameters associated with this path</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            responses: response codes for this path, and a schema reference and the description if needed.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>NOTE: The description item will reference markdown files in <code>swagger-def/info/</code>. This change is further described in a recent <a href="https://github.com/transcom/mymove/pull/7435" target="_blank" rel="noopener noreferrer">PR</a>.                </p><p>An example of the <code>Moves</code> path is as follows:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">  /moves:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    get:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      summary: listMoves</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      description:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          $ref: &#x27;info/{file_name}.md&#x27;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      operationId: listMoves</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      tags:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        - moveTaskOrder</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      produces:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        - application/json</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      parameters:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        - in: query</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          name: since</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          type: string</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          format: date-time</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          description: Only return moves updated since this time. Formatted like &quot;2021-07-23T18:30:47.116Z&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      responses:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;200&#x27;:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          description: Successfully retrieved moves. A successful fetch might still return zero moves.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          schema:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            $ref: &#x27;#/definitions/ListMoves&#x27;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;401&#x27;:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          $ref: &#x27;responses/PermissionDenied.yaml&#x27;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;403&#x27;:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          $ref: &#x27;responses/PermissionDenied.yaml&#x27;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;500&#x27;:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          $ref: &#x27;#/responses/ServerError&#x27;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="description-section-and-the-response-body"></a>Description Section and the response body<a class="hash-link" href="#description-section-and-the-response-body" title="Direct link to heading">#</a></h4><p>In your endpoint description make sure that the following fields are included when necessary:</p><ul><li>required - fields that are required are listed in the description section.</li><li>x-nullable - this indicates that the value of a particular property may be null. It will also return null if the value doesn&#x27;t exist otherwise it will be omitted if x-nullable is false.</li><li>x-omitempty -  this extension is good to add and set it to false if we don&#x27;t want that field to be omitted if it is empty.</li><li>readOnly - sometimes you will need specify a readyonly property, for example when the property differs in a GET from a POST or PATCH. Note: readOnly properties are included in responses but not in requests.</li><li>eTag - An entity tag is provided so that a browser client or a script can make conditional REST requests using optimistic concurrency control. All eTags must be marked as readOnly.</li></ul><p>An example of the ListMove description is as follows:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">      ListMove:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        description:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            $ref: &#x27;info/{file_name}.md&#x27;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        type: object</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        properties:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          id:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            example: 1f2270c7-7166-40ae-981e-b200ebdf3054</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            format: uuid</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            type: string</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          moveCode:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            type: string</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            example: &#x27;HYXFJF&#x27;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            readOnly: true</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          createdAt:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            format: date-time</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            type: string</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            readOnly: true</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          orderID:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            example: c56a4180-65aa-42ec-a945-5fd21dec0538</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            format: uuid</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            type: string</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          referenceId:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            example: 1001-3456</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            type: string</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          availableToPrimeAt:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            format: date-time</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            type: string</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            x-nullable: true</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            readOnly: true</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          updatedAt:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            format: date-time</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            type: string</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            readOnly: true</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          ppmType:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            type: string</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            enum:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">              - FULL</span></span><span class="token-line" style="color:#393A34"><span class="token plain">              - PARTIAL</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          ppmEstimatedWeight:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            type: integer</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          eTag:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            type: string</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            readOnly: true</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>For information on error responses, check out: <a href="https://transcom.github.io/mymove-docs/docs/dev/contributing/backend/API-Errors#api-errors" target="_blank" rel="noopener noreferrer">API Errors Guide</a></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="gen-files"></a>Gen files:<a class="hash-link" href="#gen-files" title="Direct link to heading">#</a></h4><p>Once you finishing updating the yaml files with the new endpoint information make sure to run your make commands like <code>make swagger-generate</code> to autogenerate your swagger files, or simply run <code>make server_run</code>,
which runs your server and other useful make commands in one go.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="creating-a-handler"></a>Creating a Handler:<a class="hash-link" href="#creating-a-handler" title="Direct link to heading">#</a></h2><p>Now you&#x27;re ready to add your endpoint to the <code>handlers</code> folder. Start building out the service object before creating your handler.
For more information about service objects and when to create one: <a href="https://transcom.github.io/mymove-docs/docs/dev/contributing/backend/service-objects" target="_blank" rel="noopener noreferrer">Service Objects</a>.</p><p>An important note about service objects: The service layer is where we will store our business logic and connect to the database. Once a service object is created, it will be passed in to the handler <code>NewPrimeAPIHandler</code> function in <code>pkg/handlers/primeapi/api.go</code>,
and the handler will only be aware of the service object interface, while the service object will contain all of the rules and validations as well as accessing object from the database.</p><p>Handlers must never hit the database. Ideally, endpoint handlers are for type validations.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="steps-to-creating-a-new-handler"></a>Steps to creating a new handler:<a class="hash-link" href="#steps-to-creating-a-new-handler" title="Direct link to heading">#</a></h4><ol><li>Add a handler for the endpoint</li><li>Add payload_to_model converters<ul><li>this is a good place to check data types and null values.</li></ul></li><li>model_to_payload functions<ul><li>Once we have either modified the model or added something to our model, it must be converted back into a payload in order to be returned by the handler.</li></ul></li><li>Create handler type and Handle function</li><li>Add tests for the handler<ul><li>Add test code<div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain"> * Use testdatagen functions [[Understanding Testdatagen Functions]]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li>Add mocks (only if absolutely necessary): <a href="https://transcom.github.io/mymove-docs/docs/dev/testing/writing-tests/generate-mocks-with-mockery" target="_blank" rel="noopener noreferrer">Generating Mocks with mockery</a></li></ul></li></ol><p>Here is an example of what the <code>ListMovesHandler</code> will look like:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">// Handle fetches all moves with the option to filter since a particular date. Optimized version.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">func (h ListMovesHandler) Handle(params movetaskorderops.ListMovesParams) middleware.Responder {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    logger := h.LoggerFromRequest(params.HTTPRequest)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    appCtx := appcontext.NewAppContext(h.DB(), logger)</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    var searchParams services.MoveTaskOrderFetcherParams</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    if params.Since != nil {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        since := handlers.FmtDateTimePtrToPop(params.Since)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        searchParams.Since = &amp;since</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    mtos, err := h.MoveTaskOrderFetcher.ListPrimeMoveTaskOrders(appCtx, &amp;searchParams)</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    if err != nil {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        logger.Error(&quot;Unexpected error while fetching moves:&quot;, zap.Error(err))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return movetaskorderops.NewListMovesInternalServerError().WithPayload(payloads.InternalServerError(nil, h.GetTraceID()))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    payload := payloads.ListMoves(&amp;mtos)</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    return movetaskorderops.NewListMovesOK().WithPayload(payload)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="connecting-the-handler-to-the-service-object"></a>Connecting the Handler to the Service Object:<a class="hash-link" href="#connecting-the-handler-to-the-service-object" title="Direct link to heading">#</a></h4><p>Once you create your handler type and Handle function, it can be added to api.go. This file is also where you can connect your service object to the handler.
For example, our ListsMoves Handler will be passed the service object interface as follows:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">primeAPI.MoveTaskOrderListMovesHandler = ListMovesHandler{</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ctx,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    movetaskorder.NewMoveTaskOrderFetcher(),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Additionally in your file containing the handler make sure to pass in the services to your struct:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">type ListMovesHandler struct {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    handlers.HandlerContext</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    services.MoveTaskOrderFetcher</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="how-to-handle-errors"></a>How to handle errors<a class="hash-link" href="#how-to-handle-errors" title="Direct link to heading">#</a></h4><p>For more information on how we handle errors,  check out our detailed <a href="https://github.com/transcom/mymove-docs/blob/720592c63db4bffe402a801417f7c14772573c28/docs/dev/contributing/backend/API-Errors.md" target="_blank" rel="noopener noreferrer">documentation</a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="add-event-key-and-update-event-map"></a>Add event key and update event map<a class="hash-link" href="#add-event-key-and-update-event-map" title="Direct link to heading">#</a></h3><p>Each API has a corresponding file in <code>/pkg/services/event/&lt;apiName&gt;_endpoint.go</code></p><ol><li>Add new <code>const</code> to represent event key</li><li>Add event key to endpoint map in the same file, using the event key name, api name, and operation ID.</li></ol><p>An example of an event key for MoveTaskOrder Create Handler is as follows:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">// MoveTaskOrderCreateEventKey is a key containing MoveTaskOrder.Create</span></span><span class="token-line" style="color:#393A34"><span class="token plain">const MoveTaskOrderCreateEventKey KeyType = &quot;MoveTaskOrder.Create&quot;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The event would be added to the event map called eventModels:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">var eventModels = map[KeyType]eventModel{</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    EndpointEventKey:                    {EndpointEventKey, models.Model{}}, // this is an example</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    NewEndpointEventKey:                 {NewEndpointEventKey, models.Model{}}, // this is an example</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    MoveTaskOrderCreateEventKey:         {MoveTaskOrderCreateEventKey, models.Move{}},</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>If you&#x27;d like to learn more about event triggers, you can find more details <a href="https://github.com/transcom/mymove-docs/blob/720592c63db4bffe402a801417f7c14772573c28/docs/dev/contributing/backend/How-to-Add-an-Event-Trigger.md" target="_blank" rel="noopener noreferrer">here</a>.</p></div><footer class="docusaurus-mt-lg"><div class="row"><div class="col"><a href="https://github.com/transcom/mymove-docs/edit/main/docs/dev/contributing/backend/Guide-to-Creating-an-Endpoint.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/mymove-docs/docs/dev/contributing/backend/Feature-Flags-in-the-App"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Feature-Flags-in-the-App</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/mymove-docs/docs/dev/contributing/backend/How-to-Add-an-Event-Trigger"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">How-to-Add-an-Event-Trigger Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#adding--a-new-entry-into-the-yaml" class="table-of-contents__link">Adding  a new entry into the yaml</a></li><li><a href="#creating-a-handler" class="table-of-contents__link">Creating a Handler:</a><ul><li><a href="#add-event-key-and-update-event-map" class="table-of-contents__link">Add event key and update event map</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/about">About</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/help">Help</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/vault">Vault</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/tutorial">Docusaurus Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Contributing</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/dev/contributing/frontend">Frontend</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/dev/contributing/backend">Backend</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/dev/contributing/database">Database</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/dev/testing">Testing</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/transcom/mymove-docs" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://docusaurus.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Docusaurus Official Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 United States Transportation Command. Built with Docusaurus.</div></div></div></footer></div>
<script src="/mymove-docs/assets/js/runtime~main.30b48e55.js"></script>
<script src="/mymove-docs/assets/js/main.b3ed7c5f.js"></script>
</body>
</html>