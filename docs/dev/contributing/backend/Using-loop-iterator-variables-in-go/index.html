<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.5">
<title data-react-helmet="true">Using-loop-iterator-variables-in-go | MilMove Developer Portal</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://transcom.github.io/mymove-docs//mymove-docs/docs/dev/contributing/backend/Using-loop-iterator-variables-in-go"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Using-loop-iterator-variables-in-go | MilMove Developer Portal"><meta data-react-helmet="true" name="description" content="TOC"><meta data-react-helmet="true" property="og:description" content="TOC"><link data-react-helmet="true" rel="shortcut icon" href="/mymove-docs/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://transcom.github.io/mymove-docs//mymove-docs/docs/dev/contributing/backend/Using-loop-iterator-variables-in-go"><link data-react-helmet="true" rel="alternate" href="https://transcom.github.io/mymove-docs//mymove-docs/docs/dev/contributing/backend/Using-loop-iterator-variables-in-go" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://transcom.github.io/mymove-docs//mymove-docs/docs/dev/contributing/backend/Using-loop-iterator-variables-in-go" hreflang="x-default"><link rel="stylesheet" href="/mymove-docs/assets/css/styles.d6ed9481.css">
<link rel="preload" href="/mymove-docs/assets/js/runtime~main.2c5d0225.js" as="script">
<link rel="preload" href="/mymove-docs/assets/js/main.2f3bd36f.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/mymove-docs/"><img src="/mymove-docs/img/logo.svg" alt="MilMove Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/mymove-docs/img/logo.svg" alt="MilMove Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">MilMove.dev</b></a><a class="navbar__item navbar__link" href="/mymove-docs/docs/about/">About</a><a class="navbar__item navbar__link navbar__link--active" href="/mymove-docs/docs/">Docs</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link">APIs</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/mymove-docs/api/prime">Prime</a></li><li><a class="dropdown__link" href="/mymove-docs/api/support">Support</a></li></ul></div><a class="navbar__item navbar__link" href="/mymove-docs/docs/help/">Help</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/transcom/mymove" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>mymove<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/mymove-docs/docs/">MilMove Developer Docs</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Getting Started</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Contributing</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Frontend</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Backend</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/">Backend</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/API-Errors">API-Errors</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/API-Programming-Guide">API-Programming-Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/API-Style-Guide">API-Style-Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/Backend-Programming-Guide">Backend Programming Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/Backend-Structure">Backend Structure</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/Dockerfile-use,-purpose,-and-documentation">Dockerfile-use,-purpose,-and-documentation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/Feature-Flags-in-the-App">Feature-Flags-in-the-App</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/Guide-to-Creating-an-Endpoint">Guide-to-Creating-an-Endpoint</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/How-to-Add-an-Event-Trigger">How-to-Add-an-Event-Trigger</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/How-to-Set-Up-a-Feature-Flag">How to Set Up a Feature Flag</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/Push-Notifications-to-Prime">Push-Notifications-to-Prime</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/Session-Management">Session-Management</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/Using-EagerPreload-in-Pop">Using-EagerPreload-in-Pop</a></li><li class="menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/Using-loop-iterator-variables-in-go">Using-loop-iterator-variables-in-go</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/WIP-Server-side-validation">WIP-Server-side-validation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/access-global-variables">How to Access a Global Application Variable</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/add-application-logging">How to Add Application Logging</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/handle-backend-errors">How to handle back-end errors</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/route-planner">Route Planner Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/service-objects">Backend Service Objects Development Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/soft-delete">How to Soft Delete</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/time">Time in Golang</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/dev/contributing/backend/use-optimistic-locking">What Is Optimistic Locking?</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Database</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Code Analysis</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Versioning</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Testing</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Tools</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1>Using-loop-iterator-variables-in-go</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="toc"></a>TOC<a class="hash-link" href="#toc" title="Direct link to heading">#</a></h2><ul><li><a href="#introduction">Introduction</a></li><li><a href="#problem-manifestation">Problem Manifestation</a></li><li><a href="#discovery">Discovery</a></li><li><a href="#how-to-fix">How to Fix</a></li><li><a href="#references">References</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="introduction"></a>Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">#</a></h2><p>When writing loops in Go, you should be aware of how Go instantiates and uses loop variables. Consider this example
<a href="https://github.com/transcom/mymove/blob/b173c32688c6f1e4fedc58aaf46fd88e4afb04af/pkg/handlers/primeapi/payloads/model_to_payload.go#L55-L58" target="_blank" rel="noopener noreferrer">from our code history</a>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly go"><pre tabindex="0" class="prism-code language-go codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> m </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">range</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">moveTaskOrders </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    payload</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">MoveTaskOrder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">m</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Go will create a single variable <code>m</code> that receives a copy of each item in the <code>moveTaskOrders</code> slice. Because <code>m</code> is
not reallocated with each loop iteration, taking the address of m (<code>&amp;m</code>) like done above will result in an identical
pointer value every time through the loop. That can have subtle consequences that you need to keep in mind.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="problem-manifestation"></a>Problem Manifestation<a class="hash-link" href="#problem-manifestation" title="Direct link to heading">#</a></h2><p>The purpose of the code above is to translate a tree of model structs to a swagger-generated payload struct to be
returned by an endpoint. However, in some cases during this translation, we take the addresses of items and
<a href="https://github.com/transcom/mymove/blob/b173c32688c6f1e4fedc58aaf46fd88e4afb04af/pkg/handlers/primeapi/payloads/model_to_payload.go#L181-L183" target="_blank" rel="noopener noreferrer">copy them to their corresponding fields</a>
in the payload structure:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly go"><pre tabindex="0" class="prism-code language-go codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">primemessages</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Address</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    City</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">       </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">address</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">City</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    State</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">      </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">address</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">State</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    PostalCode</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">address</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PostalCode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The behavior we were seeing in the case above was that some fields like those above in the payload&#x27;s <code>Address</code> structure
appeared to be the same regardless of what was in the database or the <code>Address</code> model (both of which were correct).
In fact, those fields would always be set to the values in the <em>last</em> <code>Address</code> that was processed in the loop. This is
consistent with the Go loop behavior mentioned above since the payload fields point to the correct
values in each iteration, but the subsequent iterations will overwrite the data pointed to and therefore make
them all appear to be the same after each loop iteration.</p><p>Note that this does not happen to every field in the payload because we are often not doing a direct pointer copy.
If we&#x27;re just copying a value type to another value type, a copy of the value is being made so it&#x27;s disassociated
from the source. If we&#x27;re copying a pointer to data that is not being replaced -- for instance, if the model was
already storing a <code>*string</code> for instance, then we seem to be OK too since that pointer is to a different piece of memory, not
the loop iterator variable. It&#x27;s only a problem when we&#x27;re copying the address of some item in the loop
iterator variable (at least in this particular case) since that memory location will not change across iterations.
As you can see, there are some subtleties involved.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="discovery"></a>Discovery<a class="hash-link" href="#discovery" title="Direct link to heading">#</a></h2><p>We recently upgraded to a newer version of <code>golangci-lint</code> which includes a newer <code>gosec</code> that will flag cases where
it thinks this situation occurs. The specific linter warning returned is <code>G601: Implicit memory aliasing of items
from a range statement</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="how-to-fix"></a>How to Fix<a class="hash-link" href="#how-to-fix" title="Direct link to heading">#</a></h2><p>The most straightforward fix is to make a local copy of the loop iterator variable within the loop itself, then
take the address of it. Since that local variable is scoped to the loop, it should be a different memory address
with each iteration. So, given our initial example above, we could change it to the following to prevent the
overwriting scenario described above:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly go"><pre tabindex="0" class="prism-code language-go codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> m </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">range</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">moveTaskOrders </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    copyOfM </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> m </span><span class="token comment" style="color:#999988;font-style:italic">// Make copy to avoid implicit memory aliasing of items from a range statement.</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    payload</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">MoveTaskOrder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">copyOfM</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Another alternative is to take the address of the slice elements instead:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly go"><pre tabindex="0" class="prism-code language-go codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">range</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">moveTaskOrders </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Take the address of the slice element to avoid implicit memory aliasing of items from a range statement.</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    payload</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">MoveTaskOrder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">moveTaskOrders</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>If using that strategy, keep in mind that you may be storing pointers to existing slice elements, so there are some
garbage collection and concurrency concerns to consider (as noted in this <a href="https://stackoverflow.com/a/48826629" target="_blank" rel="noopener noreferrer">Stackoverflow answer</a>).</p><p>A casual observer who hasn&#x27;t been exposed to this loop behavior may see the fixes above as unnecessary, so regardless
of which fix you apply, be sure to add a comment to let them know that the fix was done on purpose and should not
be accidentally undone.</p><p>Another option that achieves a similar goal would be to change the called function/method&#x27;s signature to accept a <a href="https://goinbigdata.com/golang-pass-by-pointer-vs-pass-by-value/" target="_blank" rel="noopener noreferrer">value type rather
than a reference</a>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly go"><pre tabindex="0" class="prism-code language-go codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> m </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">range</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">moveTaskOrders </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    payload</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">MoveTaskOrder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">m</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>You would no longer need the local copy in that case as calling the method would automatically make a copy, but
you would have to refactor all calls to that function/method since you would be changing its signature.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="references"></a>References<a class="hash-link" href="#references" title="Direct link to heading">#</a></h2><ul><li>Golang Wiki: <a href="https://github.com/golang/go/wiki/CommonMistakes#using-reference-to-loop-iterator-variable" target="_blank" rel="noopener noreferrer">Using reference to loop iterator variable</a></li><li>Stack Overflow: <a href="https://stackoverflow.com/questions/48826460/using-pointers-in-a-for-loop" target="_blank" rel="noopener noreferrer">Using Pointers in a for loop</a></li><li>Stack Overflow: <a href="https://stackoverflow.com/questions/62446118/implicit-memory-aliasing-in-for-loop" target="_blank" rel="noopener noreferrer">Implicit memory aliasing in for loop</a></li><li><a href="https://www.evanjones.ca/go-gotcha-loop-variables.html" target="_blank" rel="noopener noreferrer">Go Gotcha: Don&#x27;t take the address of loop variables</a></li></ul></div><footer class="docusaurus-mt-lg"><div class="row"><div class="col"><a href="https://github.com/transcom/mymove-docs/edit/main/docs/dev/contributing/backend/Using-loop-iterator-variables-in-go.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/mymove-docs/docs/dev/contributing/backend/Using-EagerPreload-in-Pop"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Using-EagerPreload-in-Pop</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/mymove-docs/docs/dev/contributing/backend/WIP-Server-side-validation"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">WIP-Server-side-validation Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#toc" class="table-of-contents__link">TOC</a></li><li><a href="#introduction" class="table-of-contents__link">Introduction</a></li><li><a href="#problem-manifestation" class="table-of-contents__link">Problem Manifestation</a></li><li><a href="#discovery" class="table-of-contents__link">Discovery</a></li><li><a href="#how-to-fix" class="table-of-contents__link">How to Fix</a></li><li><a href="#references" class="table-of-contents__link">References</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/about">About</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/help">Help</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/vault">Vault</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Contributing</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/dev/contributing/frontend">Frontend</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/dev/contributing/backend">Backend</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/dev/contributing/database">Database</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/dev/testing">Testing</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/transcom/mymove-docs" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 United States Transportation Command. Built with Docusaurus.</div></div></div></footer></div>
<script src="/mymove-docs/assets/js/runtime~main.2c5d0225.js"></script>
<script src="/mymove-docs/assets/js/main.2f3bd36f.js"></script>
</body>
</html>