<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.5">
<title data-react-helmet="true">Troubleshoot-CAC-Reader-Issues | MilMove Developer Portal</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://transcom.github.io/mymove-docs/docs/help/Troubleshoot-CAC-Reader-Issues"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Troubleshoot-CAC-Reader-Issues | MilMove Developer Portal"><meta data-react-helmet="true" name="description" content="Here are some potential CAC reader errors and their solutions."><meta data-react-helmet="true" property="og:description" content="Here are some potential CAC reader errors and their solutions."><link data-react-helmet="true" rel="shortcut icon" href="/mymove-docs/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://transcom.github.io/mymove-docs/docs/help/Troubleshoot-CAC-Reader-Issues"><link data-react-helmet="true" rel="alternate" href="https://transcom.github.io/mymove-docs/docs/help/Troubleshoot-CAC-Reader-Issues" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://transcom.github.io/mymove-docs/docs/help/Troubleshoot-CAC-Reader-Issues" hreflang="x-default"><link rel="stylesheet" href="/mymove-docs/assets/css/styles.2fa8fb56.css">
<link rel="preload" href="/mymove-docs/assets/js/runtime~main.fc53f1e8.js" as="script">
<link rel="preload" href="/mymove-docs/assets/js/main.94ab27b9.js" as="script">
</head>
<body data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/mymove-docs/"><img src="/mymove-docs/img/logo.svg" alt="MilMove Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/mymove-docs/img/logo.svg" alt="MilMove Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">MilMove Documentation</b></a><a class="navbar__item navbar__link" href="/mymove-docs/docs/about/">About</a><a class="navbar__item navbar__link" href="/mymove-docs/docs/frontend">Frontend</a><a class="navbar__item navbar__link" href="/mymove-docs/docs/backend">Backend</a><a class="navbar__item navbar__link" href="/mymove-docs/docs/api">API</a><a class="navbar__item navbar__link" href="/mymove-docs/docs/tools">Tools</a><a class="navbar__item navbar__link" href="/mymove-docs/docs/">Docs</a><a class="navbar__item navbar__link navbar__link--active" href="/mymove-docs/docs/help/index">Help</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/transcom/mymove" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>mymove<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="dsla-search-wrapper"><div class="dsla-search-field"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/mymove-docs/docs/help/index">Go Resources</a></li><li class="menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/mymove-docs/docs/help/Troubleshoot-CAC-Reader-Issues">Troubleshoot-CAC-Reader-Issues</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="markdown"><header><h1>Troubleshoot-CAC-Reader-Issues</h1></header><p>Here are some potential CAC reader errors and their solutions. </p><header><h1>CAC Errors</h1></header><ul><li><a href="#toc">TOC</a></li><li><a href="#1-no-matching-slot-found">1. No matching slot found</a></li><li><a href="#2-no-matching-slot-found-when-card-is-plugged-in">2. No matching slot found when card IS plugged in</a></li><li><a href="#3-cannot-sign-adobe-pdf-documents-with-cac">3. Cannot sign Adobe PDF documents with CAC</a></li><li><a href="#4-using-the-prime-api-client-results-in-a-cert-authority-error">4. Using the prime-api-client results in a cert authority error</a></li><li><a href="#5-using-the-prime-api-client-results-in-a-401-unauthorized">5. Using the prime-api-client results in a 401 unauthorized</a></li></ul><header><h1>1. No matching slot found</h1></header><p>   When running a client like <code>prime-api-client</code> you may get an error as follows</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">2020/08/21 21:26:09 No matching slot found</span></span><span class="token-line" style="color:#393A34"><span class="token plain">exit status 1</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>   This means the script cannot find your card. Check that your card reader and card are properly plugged in. You can run this tool to see what is plugged in.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&gt;  pkcs11-tool --list-token-slots</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Available slots:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">No slots.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>   If your card IS plugged in, you should see</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&gt;  pkcs11-tool --list-token-slots</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Available slots:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Slot 0 (0x0): Generic Smart Card Reader Interface</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   token label        : LASTNAME.FIRSTNAME.MIDDLE.NUM...</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   token manufacturer : piv_II</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   token model        : PKCS#15 emulated</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   token flags        : login required, token initialized, PIN initialized</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   hardware version   : 0.0</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   firmware version   : 0.0</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   serial num         : hexadecimalserial</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   pin min/max        : 4/8</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><header><h1>2. No matching slot found when card IS plugged in</h1></header><p>   Sometimes you might see that error even if your card is plugged in.
That can happen if you have more than one smartcard-like object plugged in, like a <strong>Yubikey</strong>.</p><p>   This may show up as the following error too:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">Ensure CAC reader and card inserted: pkcs11: the token has no such object</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>   That&#x27;s because the script defaults to picking one of the slots, and gets confused by the Yubikey, instead of checking all of them to find your CAC. </p><p>   You <em>should</em> be able to see the Yubikey slot information when you run this tool. </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">&gt;  pkcs11-tool --list-token-slots</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Slot 0 (0x0): Generic Smart Card Reader Interface</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   ...</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Slot 1 (0x4): Yubico YubiKey OTP+FIDO+CCID</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   ...</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>   To solve this you can do either of the following</p><p>   a) Remove the Yubikey when using the client and your CAC card.</p><p>   b) Tell the client to select which token to use. </p><p>   To select the token in the client you use the <code>--token-label</code> argument. </p><p>   The token label is the one listed in your slot info in the format <code>LASTNAME.FIRSTNAME.MIDDLE.NUM...</code> and yes, the three periods are included.</p><p>   So you need to pass that into the client as follows</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">go run ./cmd/prime-api-client --tokenlabel LASTNAME.FIRSTNAME.MIDDLE.NUM... --cac --hostname api.stg.move.mil --port 443 fetch-mto-updates</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>   I just save the above as an alias (minus the fetch-mto-updates) to reuse whenever I need to hit staging.</p><header><h1>3. Cannot sign Adobe PDF documents with CAC</h1></header><p>   i. In adobe acrobat, go to Preferences &gt; Signatures &gt; Creation and Appearance &gt; More. </p><p>   ii. Set default signing to CAdES-Equivalent and make sure CryptoTokenKit support is enabled.</p><p>   iii. Then (again in Preferences &gt; Signatures Dialog) under Identities and Trusted Certificates &gt; More &gt;PKCS#11 Modules. Choose attach module and put in the path to pkcs. </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">  On my computer it was `/usr/local/lib/opensc-pkcs11.so`</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>   iv. Then Refresh, in the left sidebar you should have a new entry called OpenSC smartcard, with your card listed under that. You can then Log in with your PIN.</p><header><h1>4. Using the prime-api-client results in a cert authority error</h1></header><p>If you are getting certificate authority error like the one below when trying to execute commands against staging using the <code>prime-api-client</code> then you need to ensure that you are trusting the DOD Root Certs in your Keychain and have loaded all the DOD certs in your keychain as well. For details on adding them properly see [[Using-your-CAC-in-Browsers-on-MacOS]]</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><pre tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">2020/09/23 16:13:40 Get operation to https://api.stg.move.mil:443/prime/v1/move-task-orders failed, check if server is running : x509: certificate signed by unknown authority</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><header><h1>5. Using the prime-api-client results in a 401 unauthorized</h1></header><p>If you are getting a 401 or 403 when making prime api calls to staging this means your certificate is not authorized in staging. This will happen when you get a new cac or renewed one as it will have new certs. See [[use-mtls-with-cac]] for details to create the migration for a new cac for the first time or replace your old cac cert</p></div><footer class="docusaurus-mt-lg"><div class="row"><div class="col"><a href="https://github.com/transcom/mymove-docs/edit/main/docs/help/Troubleshoot-CAC-Reader-Issues.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/mymove-docs/docs/help/index"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Go Resources</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/about">About</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/tutorial">Docusaurus Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Contributing</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/frontend">Frontend</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/backend">Backend</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/api">API</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/tools">Tools</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/transcom/mymove-docs" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>MilMove Documentation GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/transcom/mymove" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>MilMove GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://docusaurus.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Docusaurus Official Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 United States Transportation Command. Built with Docusaurus.</div></div></div></footer></div>
<script src="/mymove-docs/assets/js/runtime~main.fc53f1e8.js"></script>
<script src="/mymove-docs/assets/js/main.94ab27b9.js"></script>
</body>
</html>